@page "/bookmarks"
@attribute [Authorize]

<PageTitle>My Bookmarks - Electronic Case Tracking System</PageTitle>

<div>
@if (_isLoading && _bookmarks == null)
{
    <RadzenStack Gap="1rem">
        <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.SpaceBetween" AlignItems="AlignItems.Center"
                      Style="margin-bottom: 1rem;">
            <RadzenSkeleton Style="width: 240px; height: 32px;" Animation="SkeletonAnimation.Wave" />
        </RadzenStack>
        <RadzenStack Gap="0" Style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.12); border-radius: 8px; padding: 1rem;">
            <RadzenSkeleton Style="width: 100%; height: 40px; margin-bottom: 0.75rem;" Animation="SkeletonAnimation.Wave" />
            @for (var i = 0; i < 5; i++)
            {
                <RadzenSkeleton Style="width: 100%; height: 36px; margin-bottom: 0.5rem;" Animation="SkeletonAnimation.Wave" />
            }
        </RadzenStack>
    </RadzenStack>
}
else
{

<RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.SpaceBetween" AlignItems="AlignItems.Center"
              Style="margin-bottom: 1rem;">
    <RadzenText TextStyle="TextStyle.H5" Style="font-weight: 700; color: rgba(255, 255, 255, 0.87); margin: 0;">
        My Bookmarks
    </RadzenText>
</RadzenStack>

@if (!_hasBookmarks && _bookmarks != null && !_bookmarks.Any())
{
    <RadzenStack AlignItems="AlignItems.Center" Gap="1rem" Style="padding: 3rem 0;">
        <span class="material-symbols-outlined" style="font-size: 48px; color: rgba(255, 255, 255, 0.3);">bookmarks</span>
        <RadzenText TextStyle="TextStyle.Body1" Style="color: rgba(255, 255, 255, 0.5);">
            No bookmarked cases yet. Open a case and click the bookmark icon to save it here.
        </RadzenText>
    </RadzenStack>
}
else
{
<RadzenDataGrid @ref="_grid" TItem="LineOfDutyCase"
                Data="@_bookmarks"
                Count="@_count"
                LoadData="@LoadData"
                IsLoading="@_isLoading"
                SelectionMode="DataGridSelectionMode.Multiple"
                AllowRowSelectOnRowClick="true"
                @bind-Value="_selectedBookmarks"
                AllowSorting="true"
                AllowFiltering="true"
                FilterMode="FilterMode.Simple"
                PageSize="10"
                AllowPaging="true"
                ShowPagingSummary="true"
                PagingSummaryFormat="@("Displaying page {0} of {1} ({2} records)")"
                PageSizeOptions="@(new[] { 5, 10, 25, 50 })"
                PagerHorizontalAlign="HorizontalAlign.Center"
                GridLines="DataGridGridLines.Both"
                Style="border: 1px solid rgba(255, 255, 255, 0.12); border-radius: 8px;">
    <Columns>
        <RadzenDataGridColumn TItem="LineOfDutyCase" Property="CaseId" Title="Case ID" Width="220px">
            <Template Context="lodCase">
                <div class="case-id-cell">
                    <RadzenLink Path="@($"case/{lodCase.CaseId}?from=bookmarks")" Text="@lodCase.CaseId" />
                    <RadzenButton Icon="bookmark_remove" ButtonStyle="ButtonStyle.Light" Variant="Variant.Text" Size="ButtonSize.ExtraSmall"
                                  class="bookmark-btn"
                                  title="Remove bookmark"
                                  Click="@(() => OnRemoveBookmark(lodCase))" />
                </div>
            </Template>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn TItem="LineOfDutyCase" Property="MemberName" Title="Member" Width="220px" />
        <RadzenDataGridColumn TItem="LineOfDutyCase" Property="MemberRank" Title="Rank" Width="80px" TextAlign="TextAlign.Center" />
        <RadzenDataGridColumn TItem="LineOfDutyCase" Property="Unit" Title="Unit" />
        <RadzenDataGridColumn TItem="LineOfDutyCase" Property="IncidentType" Title="Type">
            <Template Context="lodCase">
                @FormatEnum(lodCase.IncidentType)
            </Template>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn TItem="LineOfDutyCase" Property="IncidentDate" Title="Incident Date" FormatString="{0:yyyy-MM-dd}" />
        <RadzenDataGridColumn TItem="LineOfDutyCase" Property="ProcessType" Title="Process">
            <Template Context="lodCase">
                @FormatEnum(lodCase.ProcessType)
            </Template>
        </RadzenDataGridColumn>
    </Columns>
</RadzenDataGrid>
}

}
</div>
